<HTML>
<HEAD>
<TITLE>Configurar Usuario (DataFolder)</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="../servlet/Tool?style/portalrrhh.css" type="text/css">
<script language="JavaScript">
<!--
function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);
// -->
</script>
<script language="JavaScript">
<!--
function Valida(form, form_claves){
	var seguir = true;
	if (seguir)	{
		form.submit();
	}
}
function Inicio() {
	window.focus();
	<if (MSGRESUL)>
	//window.opener.location.reload();
	alert("${MSGRESUL}");
	
	</if>
	<if bloqueo>alert('Usuario bloqueado, cambiar clave para desbloquear.');</if>
}

function AsignaUnidRel(emp, uni, tipo) {
	var url = "../servlet/MantenerUsuario"
	url += "?rut=${rut}&accion=${accion}&rel_uni="+uni+"&unirel=1&rel_emp="+emp
	url += "&rel_tipo="+tipo;
	//alert(url);
	document.location.href = url;
}

function MM_findObj(n, d) { //v4.0
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_showHideLayers() { //v3.0
  var i,p,v,obj,args=MM_showHideLayers.arguments;
  for (i=0; i<(args.length-2); i+=3) if ((obj=MM_findObj(args[i]))!=null) { v=args[i+2];
    if (obj.style) { obj=obj.style; v=(v=='show')?'visible':(v='hide')?'hidden':v; }
    obj.visibility=v; }
}

function ocultarRuts() {
	<list accesos as a>
	<if (a.acc_tipo) == "R">LayerRut${a.acc_id}.style.visibility="hidden";</if>
	</list>
}

function selecRestric(acceso_id) {
	ocultarRuts();
	eval("LayerRut"+acceso_id+".style.visibility='inherit'");
}

function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

function MM_nbGroup(event, grpName) { //v3.0
  var i,img,nbArr,args=MM_nbGroup.arguments;
  if (event == "init" && args.length > 2) {
    if ((img = MM_findObj(args[2])) != null && !img.MM_init) {
      img.MM_init = true; img.MM_up = args[3]; img.MM_dn = img.src;
      if ((nbArr = document[grpName]) == null) nbArr = document[grpName] = new Array();
      nbArr[nbArr.length] = img;
      for (i=4; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
        if (!img.MM_up) img.MM_up = img.src;
        img.src = img.MM_dn = args[i+1];
        nbArr[nbArr.length] = img;
    } }
  } else if (event == "over") {
    document.MM_nbOver = nbArr = new Array();
    for (i=1; i < args.length-1; i+=3) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = (img.MM_dn && args[i+2]) ? args[i+2] : args[i+1];
      nbArr[nbArr.length] = img;
    }
  } else if (event == "out" ) {
    for (i=0; i < document.MM_nbOver.length; i++) {
      img = document.MM_nbOver[i]; img.src = (img.MM_dn) ? img.MM_dn : img.MM_up; }
  } else if (event == "down") {
    if ((nbArr = document[grpName]) != null)
      for (i=0; i < nbArr.length; i++) { img=nbArr[i]; img.src = img.MM_up; img.MM_dn = 0; }
    document[grpName] = nbArr = new Array();
    for (i=2; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = img.MM_dn = args[i+1];
      nbArr[nbArr.length] = img;
  } }
}
//-->
</script>
<script language="JavaScript" src="../servlet/Tool?scripts/ExisteFoto.js">
</script>
<script language="JavaScript" src="../servlet/Tool?scripts/ventanas.js">
</script>
<script language="JavaScript" src="../servlet/Tool?scripts/Cambiarclave.js">
</script>
</HEAD>

<BODY BGCOLOR=#000000 leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" onLoad="Inicio();MM_preloadImages('../servlet/Tool?images/configdf/botones/aplicar_over.jpg','../servlet/Tool?images/configdf/botones/asigroles_down.jpg','../servlet/Tool?images/configdf/botones/asigroles_over.jpg','../servlet/Tool?images/configdf/botones/asigpermisos_up.jpg','../servlet/Tool?images/configdf/botones/asigpermisos_over.jpg','../servlet/Tool?images/configdf/botones/cerrar_over.jpg','../servlet/Tool?images/configdf/botones/uni3.jpg','images/usu_11_over.jpg','images/usu_12_over.jpg','images/usu_06_over.jpg','images/usu_13_over.jpg','images/usu_07_over.jpg','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_06_over.jpg','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_07_over.jpg','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_11_over.jpg','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_12_over.jpg','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_13_over.jpg')">
<table width=577 border=0 cellpadding=0 cellspacing=0 height="336">
  <tr> 
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=16 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=9 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=105 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=112 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=87 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=100 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=101 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=93 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=7 height=1></td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/spacer.gif" width=15 height=1></td>
  </tr>
  <tr> 
    <td rowspan=6> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_01.jpg" width=16 height=346></td>
    <td colspan=8> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_02.jpg" width=614 height=14></td>
    <td rowspan=4> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_03.jpg" width=15 height=148></td>
  </tr>
  <tr> 
    <td colspan=8 bgcolor="CECEE6"> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_04.jpg" width="1" height="91"> 
    </td>
  </tr>
  <tr> 
    <td colspan=5> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_05.jpg" width=413 height=23></td>
    <td colspan="3" rowspan="2" bgcolor="CECEE6">&nbsp; </td>
  </tr>
  <tr> 
    <td colspan=3 rowspan=2 valign="bottom" bgcolor="CECEE6">&nbsp;</td>
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_10.jpg" width=87 height=20></td>
    <td bgcolor="CECEE6">&nbsp; </td>
  </tr>
  <tr> 
    <td colspan=6> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_14.jpg" width=403 height=10></td>
  </tr>
  <tr> 
    <td> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_15.jpg" width=9 height=188></td>
    <td colspan=6 bgcolor="BEBFDE" valign="top">&nbsp; </td>
    <td colspan=2> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_17.jpg" width=22 height=188></td>
  </tr>
  <tr> 
    <td colspan=10> <img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_18.jpg" width=645 height=16></td>
  </tr>
</table>
<div id="Layer8" style="position:absolute; width:609px; height:108px; z-index:10; left: 17px; top: 13px"> 
  <table width="100%" border="0">
    <tr> 
      <td width="17%"> 
        <table border="1" width="98" cellpadding="3" cellspacing="0" height="110">
          <tr> 
            <td height="111" width="92" valign="middle" align="center"><img src="${GetProp("server.datafolder")}/images/DataFolder/Trabajadores/${foto}" width="79" height="100" onError="existeFoto(this)" border="0"></td>
          </tr>
        </table>
      </td>
      <td width="83%" valign="top"> 
        <table border="0" width="98%" align="center">
          <tr align="center"> 
            <td height="19" colspan="3" class="tituloTabla"> <if (accion == "C")>Crear 
              nuevo Usuario (DataFolder) <else>Configurar Usuario (DataFolder) 
              </if> </td>
          </tr>
          <tr> 
            <td height="19" class="tituloTabla2" width="11%" >Nombre</td>
            <td height="19" colspan="2" class="detalleTabla" > <if accion == "M">${nombre}</if></td>
          </tr>
          <tr> 
            <td height="19" width="11%" class="tituloTabla2" > Cargo</td>
            <td height="19" colspan="2" class="detalleTabla" > ${cargo}</td>
          </tr>
          <!--
		<tr> 
          <td height="19" class="tituloTabla2" valign="top" width="11%">Anexo</td>
          <td height="19" valign="top" colspan="2" class="detalleTabla"> ${anexo}</td>
        </tr>
        <tr> 
          <td height="19" class="tituloTabla2" valign="top" width="11%">Email</td>
          <td height="19" valign="top" colspan="2" class="detalleTabla"> ${email} 
          </td>
        </tr>
		-->
          <tr> 
            <td align="center" colspan="2"> <if bloqueo><font face="Arial, Helvetica, sans-serif" size="3" color="#993300"><b>Usuario 
              bloqueado, cambiar clave para desbloquear.</b></font></if></td>
            <td height="9" valign="top" align="center" width="41%" >&nbsp;</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</div>

<form name="Permisos" method="post" action="../servlet/MantenerUsuario">
  <div id="LayRoles" style="position:absolute; width:592px; height:183px; z-index:1; left: 8px; top: 159px; visibility: hidden"> 
    <table width="94%" border="0" cellspacing="0" cellpadding="0" align="center">
      <tr>
        <td><font size="1">Roles</font></td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td height="139" valign="top">
          <div id="LayerRol" style="position:absolute; width:468px; height:135px; z-index:2; overflow: auto; background-color: #E9E9E9; layer-background-color: #E9E9E9; border: 1px none #000000; left: auto; top: auto"> 
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <if (roles)> <list roles as r> <if (r.selec)> 
              <tr> 
                <td width="36%" class="detalleTabla"> 
                  <input type="checkbox" name="rol" value="${r.rol_id}" checked>
                  <input type="hidden" name="accion_rol_${r.rol_id}" value="existe">
                  ${r.rol_glosa} </td>
                <td width="64%" class="detalleTabla">${r.rol_desc} </td>
              </tr>
              <else> 
              <tr> 
                <td width="36%" class="detalleTabla"> 
                  <input type="checkbox" name="rol" value="${r.rol_id}">
                  ${r.rol_glosa} </td>
                <td width="64%" class="detalleTabla">${r.rol_desc} </td>
              </tr>
              </if> </list> <else> 
              <tr> 
                <td colspan="2" class="detalleTabla"> No existen roles disponibles</td>
              </tr>
              </if> 
            </table>
          </div>
        </td>
        <td height="139">&nbsp;</td>
      </tr>
    </table>
  </div>
  <div id="LayAccesos" style="position:absolute; width:592px; height:183px; z-index:3; left: 10px; top: 168px; visibility: visible"> 
    <table width="94%" border="0" cellspacing="0" cellpadding="0" align="center">
      <tr> 
        <td colspan="2"><font size="1">Permisos a Diferentes Opciones 
          del DataFolder</font></td>
      </tr>
      <tr> 
        <td height="100" valign="top" width="50%"> 
		  <div id="LayerAcceso" style="position:absolute; width:253px; height:160px; z-index:2; overflow: auto; background-color: #E9E9E9; layer-background-color: #E9E9E9; border: 1px none #000000; left: auto; top: auto"> 
            <table border="0" cellspacing="0" cellpadding="1" width="100%">
              <assign grupo_ant = ""> <if (accesos)> <list accesos as a> <if (grupo_ant) != (a.acc_grupo)> 
              <assign grupo_ant = a.acc_grupo> 
              <tr> 
                <td colspan="2" class="tituloTabla"><font size="1">${a.acc_grupo}</font></td>
              </tr>
              </if> 
              <tr> 
                <td class="detalleTabla"> <if (a.selec)> <assign seleccionado = "checked"> 
                  <input type="hidden" name="accion_acc_${a.acc_id}" value="existe">
                  <else><assign seleccionado = ""></if> <if (a.acc_tipo) == "R"> 
                  <input type="checkbox" name="acc" value="${a.acc_id}" ${seleccionado} onClick="selecRestric('${a.acc_id}')">
                  <else> 
                  <input type="checkbox" name="acc" value="${a.acc_id}" ${seleccionado} >
                  </if> <if (a.acc_tipo) == "R"> 
                  <input type="hidden" name="acc_tipo_${a.acc_id}" value="${a.acc_tipo}">
                  </if> ${a.acc_glosa} </td>
                <td width="16" class="detalleTabla"><if (a.acc_tipo) == "R"> <a href="javascript:;" onClick="selecRestric('${a.acc_id}'); return false"><img src="../servlet/Tool?images/configdf/botones/pers.gif" width="24" height="20" alt="Seleccionar restricciones" border="0"></a> 
                  </if></td>
              </tr>
              </list> <else> 
              <tr> 
                <td colspan="2" class="detalleTabla"> No existen permisos disponibles</td>
              </tr>
              </if> 
            </table>
          </div>
        </td>
        <td height="139" width="50%" valign="top">
		<list accesos as a><if (a.acc_tipo) == "R">
          <div id="LayerRut${a.acc_id}" style="position:absolute; width:284px; height:160px; z-index:2; overflow: visible; background-color: #E9E9E9; layer-background-color: #E9E9E9; border: 1px none #000000; left: auto; top: auto; visibility: hidden"> 
            <table border="1" cellspacing="0" cellpadding="1" width="100%" height="160">
              <tr> 
                <td height="20" class="tituloTabla"><font>${a.acc_glosa} </font></td>
              </tr>
              <tr> 
                <td height="20" class="detalleTabla"> 
                  <select name="puede_ver_${a.acc_id}" class="inputText" style="width=240">
                    <option value="N" >Ver Todos los trabajadores menos...</option>
                    <option value="S">Ver s&oacute;lo los siguientes trabajadores...</option>
                  </select>
                  <script language="JavaScript">document.Permisos.puede_ver_${a.acc_id}.value="${a.acc_puede_ver}";</script>
                </td>
              </tr>
              <tr> 
                <td valign="top"> 
                  <div id="LayerListaRut${a.acc_id}" style="position:static; width:auto; height:110px; z-index:4; left: auto; top: auto; overflow: auto; visibility: inherit"> 
                    <table border="0" cellspacing="0" cellpadding="1" width="100%">
                      <if (a.ruts)> <list a.ruts as r><if (r.selec)> 
                      <tr> 
                        <td class="detalleTabla"> 
                          <input type="checkbox" name="rut_${a.acc_id}" value="${r.rut_trab}" checked>
                          <input type="hidden" name="accion_acc_${a.acc_id}_${r.rut_trab}" value="existe">
                          <if (r.rut_trab)!=(rut)>${r.nombre} <else><b>Informaci&#243;n 
                          propia del usuario</b></if> </td>
                      </tr>
                      <else> 
                      <tr> 
                        <td class="detalleTabla"> 
                          <input type="checkbox" name="rut_${a.acc_id}" value="${r.rut_trab}">
                          <if (r.rut_trab)!=(rut)>${r.nombre} <else><b>Informaci&#243;n 
                          propia del usuario</b></if> </td>
                      </tr>
                      </if> </list> <else> 
                      <tr> 
                        <td class="detalleTabla"> No existen otros Trabajadores 
                          en la Unidad</td>
                      </tr>
                      </if> 
                    </table>
                  </div>
                </td>
              </tr>
            </table>
          </div>
		  </if></list>
        </td>
      </tr>
    </table>
  </div>
  <input type="hidden" name="clave">
  <input type="hidden" name="rut" value="${rut}">
  <input type="hidden" name="accion" value="${accion}">
  <if (unirel)>
	  <input type="hidden" name="unirel" value="${unirel}">
	  <input type="hidden" name="rel_emp" value="${rel_emp}">
	  <input type="hidden" name="rel_uni" value="${rel_uni}">
	  <input type="hidden" name="rel_tipo" value="${rel_tipo}">
  </if>
</form>
<div id="LPer" style="position:absolute; width:233px; height:35px; z-index:4; left: 17px; top: 132px; visibility: visible"> 
  <table width="10%" border="0" cellpadding="0" cellspacing="0">
    <tr> 
      <td><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_08.jpg" width=114 height=30 border="0"></td>
      <td><a href="#" onClick="MM_showHideLayers('LayRoles','','show','LayAccesos','','hide','LRol','','show','LPer','','hide')"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_09.jpg" width=112 height=30 border="0"></a></td>
    </tr>
  </table>
</div>
<div id="Layer3" style="position:absolute; width:103; height:22; z-index:50; left: 316px; top: 128px; visibility: visible"><a href="javascript:;" onclick="VentUnidadRelativa('${rut}','${accion}');return false;" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image1','','images/usu_11_over.jpg',1);MM_swapImage('Image1','','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_11_over.jpg',1)"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_11.jpg" width=100 height=20 border="0" name="Image1"></a></div>
<div id="Layer4" style="position:absolute; width:103; height:22; z-index:51; left: 421px; top: 128px; visibility: visible"><a href="javascript:;" onClick="Valida(document.Permisos, document.form1); return false;" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image2','','images/usu_12_over.jpg',1);MM_swapImage('Image2','','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_12_over.jpg',1)"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_12.jpg" width=101 height=20 border="0" name="Image2"></a></div>
<div id="Layer5" style="position:absolute; width:103; height:22; z-index:52; left: 423px; top: 103px; visibility: visible"><a href="javascript:;" onClick="VentUnidadVer('${rut}'); return false" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image4','','images/usu_06_over.jpg',1);MM_swapImage('Image4','','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_06_over.jpg',1)"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_06.jpg" width=101 height=23 border="0" name="Image4"></a></div>
<div id="Layer6" style="position:absolute; width:102px; height:22px; z-index:53; left: 528px; top: 128px; visibility: visible"><a href="javascript:;" onClick="window.close(); return false;" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image3','','images/usu_13_over.jpg',1);MM_swapImage('Image3','','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_13_over.jpg',1)"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_13.jpg" width=100 height=20 border="0" name="Image3"></a></div>
<div id="Layer7" style="position:absolute; width:103; height:22; z-index:54; left: 528px; top: 103px; visibility: visible"><a href="javascript:;" onClick="VentCargosVer('${rut}'); return false" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image5','','images/usu_07_over.jpg',1);MM_swapImage('Image5','','../servlet/Tool?images/configdf/MantenerUsuario/images/usu_07_over.jpg',1)"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_07.jpg" width=100 height=23 border="0" name="Image5"></a></div>
<div id="LRol" style="position:absolute; width:233px; height:35px; z-index:4; left: 17; top: 132; visibility: hidden"> 
  <table width="10%" border="0" cellpadding="0" cellspacing="0">
    <tr> 
      <td><a href="#" onClick="MM_showHideLayers('LayRoles','','hide','LayAccesos','','show','LRol','','hide','LPer','','show')"><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_08_up.jpg" width=114 height=30 border="0"></a></td>
      <td><img src="../servlet/Tool?images/configdf/MantenerUsuario/images/usu_09_up.jpg" width=112 height=30></td>
    </tr>
  </table>
</div>
</BODY>
</HTML>