<html>
<head>
<title>Informes Corporativos</TITLE>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_reloadPage(init) {  //reloads the window if Nav4 resized
  if (init==true) with (navigator) {if ((appName=="Netscape")&&(parseInt(appVersion)==4)) {
    document.MM_pgW=innerWidth; document.MM_pgH=innerHeight; onresize=MM_reloadPage; }}
  else if (innerWidth!=document.MM_pgW || innerHeight!=document.MM_pgH) location.reload();
}
MM_reloadPage(true);
// -->

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_showHideLayers() { //v6.0
  var i,p,v,obj,args=MM_showHideLayers.arguments;
  for (i=0; i<(args.length-2); i+=3) if ((obj=MM_findObj(args[i]))!=null) { v=args[i+2];
    if (obj.style) { obj=obj.style; v=(v=='show')?'visible':(v=='hide')?'hidden':v; }
    obj.visibility=v; }
}

function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}
//-->
</script>
<script>
	function generarInforme() {
	  var reporte = document.getElementById("reporte").value;
	  var periodo = document.getElementById("periodos").value;
	  var nombre_unidad = document.getElementById("nombre_unidad").value;
	  if(reporte == '' || periodo == -1) {
	  	alert("Favor seleccione todos los par&#225;metros para poder continuar");
	  }
	  else {
	  	if (reporte == 1){
	  		if (document.form1.gestion[0].checked == true) {
	  			url = "../servlet/cargaInformeResultadoUnidad?opcion=" + 
	  				  document.form1.gestion[0].value + "&unidades=${unidad}&nombre_unidad=${nombre_unidad}&periodo=" + periodo;
				window.open(url,"Informe2","toolbar=0,scrollbars=yes,resizable=0,height=550,width=780");
			}
			else {
	  			url = "../servlet/cargaInformeResultadoUnidad?opcion=" + 
	  				  document.form1.gestion[1].value + "&unidades=${unidad}&nombre_unidad=${nombre_unidad}&periodo=" + periodo;
				window.open(url,"Informe2","toolbar=0,scrollbars=yes,resizable=0,height=550,width=780");
			}
  		}
	  	if (reporte == 2){
	  		if (document.form1.gestion[0].checked == true) {
	  			url = "../servlet/cargaInformeResultadoUnidadColaborador?opcion=" + 
	  				  document.form1.gestion[0].value + "&unidades=${unidad}&nombre_unidad=${nombre_unidad}&periodo=" + periodo;
				window.open(url,"Informe3","toolbar=0,scrollbars=yes,resizable=0,height=550,width=780");
			}
			else {
	  			url = "../servlet/cargaInformeResultadoUnidadColaborador?opcion=" + 
	  				  document.form1.gestion[1].value + "&unidades=${unidad}&nombre_unidad=${nombre_unidad}&periodo=" + periodo;
				window.open(url,"Informe3","toolbar=0,scrollbars=yes,resizable=0,height=550,width=780");
			}
  		}
	  	if (reporte == 3){
	  		if (document.form1.gestion[0].checked == true) {
				url = "../servlet/cargaInformeResultadoUnidadClasificacion?opcion=" + 
					  document.form1.gestion[0].value + "&unidades=${unidad}&nombre_unidad=${nombre_unidad}&periodo=" + periodo;
				window.open(url,"Informe4","toolbar=0,scrollbars=yes,resizable=0,height=550,width=780");
			}
			else {
				url = "../servlet/cargaInformeResultadoUnidadClasificacion?opcion=" + 
					  document.form1.gestion[1].value + "&unidades=${unidad}&nombre_unidad=${nombre_unidad}&periodo=" + periodo;
				window.open(url,"Informe4","toolbar=0,scrollbars=yes,resizable=0,height=550,width=780");
			}
  		}
	  	if (reporte == 4){
	  		if (document.form1.gestion[0].checked == true) {
				url = "../servlet/cargaInformeResultadoEvalDes?usuarioEncargado=0" + "&periodo=" + periodo;
				window.open(url,"Informe5","toolbar=0,scrollbars=yes,resizable=0,height=550,width=800");
			}
  		}
	  	if (reporte == 5){
	  		if (document.form1.gestion[0].checked == true) {
	  			document.form1.action='../servlet/cargaInformeCorporativo?unidad=${unidad}&empresa=${empresa}&descrip=${nombre_unidad}&exportar=si&opcion='+document.form1.gestion[0].value+'&periodo='+periodo;
	  			document.form1.submit();
			}
	  		else {
	  			document.form1.action='../servlet/cargaInformeCorporativo?unidad=${unidad}&empresa=${empresa}&descrip=${nombre_unidad}&exportar=si&opcion='+document.form1.gestion[1].value+'&periodo='+periodo;
	  			document.form1.submit();
	  		}				
  		}
	  }
	}

	function fnAbrirExcel(archivo){
		if (archivo!="")
			GoInforme(archivo);
	}
	
	function GoInforme(archivo){
		document.location.href='../servlet/GeneraArchivoExcel?archivo='+archivo;
	}
	
	
	function checkIn(option) {
		if(option==1) {
			document.form1.gestion[0].checked = false;
			document.form1.gestion[1].checked = true;
		}
		else {
			document.form1.gestion[0].checked = true;
			document.form1.gestion[1].checked = false;
		}
	}

	function tipoInforme(f) {
		if(f.reporte.value==4)
		{
			btn = document.getElementById("btn_rama");
			btn.style.visibility = "hidden";
		}
		else
		{
			btn = document.getElementById("btn_rama");
			btn.style.visibility = "visible";
		}

	}
	
	
</script>

<link href="../servlet/Tool?style/ggd.css" rel="stylesheet" type="text/css">
<link href="../servlet/Tool?style/gestion.css" rel="stylesheet" type="text/css">
</head>
<body onLoad="fnAbrirExcel('${archivo}');" >
<form name="form1" method="post" action="../servlet/cargaInformeCorporativo">
	<input type="hidden" name="empresa" value="${empresa}">
	<input type="hidden" name="unidad" value="${unidad}">
	<input type="hidden" name="nombre_unidad" value="${nombre_unidad}">
	<input type="hidden" name="selectReport" value="1">
	<table width="470" height="385" border="1" cellpadding="10" cellspacing="10" class="tabla_layer_orga">
	<tr>
		<td align="center">
			<table width="100%" height="100%" border="1" cellpadding="10" cellspacing="0" >
			<tr height="20%">
				<td class="texto_titulo" align="center" colspan="2">Reportes Corporativos</td>
			</tr>
			<tr height="40%">
				<td align="center" colspan="2">
					<select name="reporte" onclick="javascript:tipoInforme(this.form);" multiple>
						<option value="1">Resultados por Perfil para Unidad</option>
						<option value="2">Resumen por Perfil de Brechas Negativas y Positivas</option>
						<option value="3">Nivel de Competencias por Perfil</option>
						<option value="4">Informe por Rut</option>
						<option value="5">Exportar Excel Maestro Personal Evaluado</option>
					</select>
				</td>
			</tr>
			<tr height="10%">
				<td align="left" class="texto_titulo">Periodo de Evaluaci&oacute;n </td>
				<td align="left">
					<select name="periodos">
						<if periodos >
									<option value="-1">seleccione periodo</option>
							<list periodos as pl>
									<option value="${pl.id_proceso}">${pl.proceso}</option>
							</list>
						</if>
					</select>
				</td>
			</tr>
			<tr height="10%">
				<td align="left" colspan="2" class="texto_titulo">
				<table border="0">
				<tr>
				<td class="texto_titulo"><div id="btn_unidad"><input type="radio" name="gestion" checked="checked" value="1" onClick="javascript:checkIn(2)"> Unidad</div></td>
				<td class="texto_titulo"><div id="btn_rama"><input type="radio" name="gestion" value="2" onClick="javascript:checkIn(1)">Rama</div></td>
				</tr>
				</table>
				</td>
			</tr>
			<tr height="20%">
				<td align="right" colspan="2" class="texto_titulo">
					<a href="#"><img src="../servlet/Tool?images/new/botones/aceptar.gif" onClick="javascript:generarInforme()" alt="Generar Informe" border="0"></a>
				</td>
			</tr>
			</table>
		</td>
	</tr>
</table>	
</form>
</body>
</html>